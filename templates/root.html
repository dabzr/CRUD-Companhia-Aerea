{% extends "layout.html" %}

{% block body %}

  <style>
    .popup {
      display: {{ session.get('popupDisplay') }};
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: white;
      border: 1px solid #ccc;
      padding: 10px;
      z-index: 9999;
      max-height: 80vh;
      width: 80%; 
      overflow-y: auto; 
    }

    .popup ul {
      list-style: none;
      padding: 0;
    }

    .popup li {
      margin-bottom: 10px;
    }
  </style>

  <form action="/root" method="post">
    <button type="submit" name="submit_button" value="log_out">Log out</button>
  </form>

  {% for item in elementos %}
      <h1>
        <form action="/root" method="post">
          <label for="elemento_title">{{ item.capitalize() }}</label>
          <button type="submit" name="submit_button" value="adicionar_{{ item }}">+</button>
          <button type="submit" name="submit_button" value="ver_{{ item }}">Ver</button>
        </form><br><br>
      </h1>
  {% endfor %}

  {% with messages = get_flashed_messages() %}
    {% if messages %}
      {% if messages[0] == 'adicionar' %}
        <div class="popup">
          <h2 for="{{ messages[2] }}">{{ messages[1] }}</h2>
          <button onclick="this.parentElement.style.display='none';">Fechar</button>
          <form action="/root" method="post">
            {{ form.hidden_tag() }}
            <ul>
              {% for campo in form._fields.items() %}
                <div>{{ campo.label() }}: {{ campo() }}</div>
              {% endfor %}
            </ul>
          </form>
        </div>
      {% else %}
         <div class="popup">
          <h2 for="elemento_name">{{ messages[1] }}</h2>
          <button onclick="this.parentElement.style.display='none';">Fechar</button>
          <ul>
            {% for i in session.get('lista') %}
              {% for key, values_string in i.items() %}
                {% if 'instance' not in key %}
                  <li>{{ key }}:{{ values_string }}</li>
                {% endif %}
              {% endfor %}
              <br>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
    {% endif %}
  {% endwith %}


{% endblock %}
