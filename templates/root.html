{% extends "layout.html" %}

{% block body %}

  <style>
    .popup {
      display: {{ session.get('popupDisplay') }};
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: white;
      border: 1px solid #ccc;
      padding: 10px;
      z-index: 9999;
      max-height: 80vh; /* Altura máxima do popup (80% da altura da viewport) */
      width: 80%; /* Largura do popup */
      overflow-y: auto; /* Adiciona scroll vertical apenas quando necessário */
    }

    .popup ul {
      list-style: none;
      padding: 0;
    }

    .popup li {
      margin-bottom: 10px; /* Espaçamento entre os itens da lista */
    }
  </style>


  {% for item in elementos %}
      <h1>
        <form action="/root" method="post">
            <label for="elemento_title">{{ item.capitalize() }}</label>
          <button type="submit" name="submit_button" value="adicionar_{{ item }}">+</button>
          <button type="submit" name="submit_button" value="ver_{{ item }}">Ver</button>
        </form><br><br>
      </h1>
  {% endfor %}

  {% with messages = get_flashed_messages() %}
    {% if messages %}
      {% if messages[0] == 'adicionar' %}
        <div class="popup">
          <h2 for="{{ messages[2] }}">{{ messages[1] }}</h2>
          <button onclick="this.parentElement.style.display='none';">Fechar</button>
          <form action="/root" method="post">
            <ul>
              {% for key, values in session.get('lista')[0].items() %}
                {% if 'instance' not in key and key != 'id' and key != 'salt' %}
                  <label for="text_{{ key }}">{{ key }}: </label>
                  <input type="text" autocomplete="off" id="input_{{ key }}" name="{{ key }}">
                {% endif %}
              {% endfor %}
            </ul>
            <button type="submit" name="submit_button" value="insert_{{ messages[1] }}">{{ messages[1] }}</button>
          </form>
        </div>
      {% else %}
         <div class="popup">
          <h2 for="elemento_name">{{ messages[1] }}</h2>
          <button onclick="this.parentElement.style.display='none';">Fechar</button>
          <ul>
            {% for i in session.get('lista') %}
              {% for key, values_string in i.items() %}
                {% if 'instance' not in key %}
                  <li>{{ key }}:{{ values_string }}</li>
                {% endif %}
              {% endfor %}
              <br>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
    {% endif %}
  {% endwith %}


{% endblock %}
